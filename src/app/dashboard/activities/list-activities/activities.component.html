<div class="container ps-activities-container">
  <span class="ps-activity-top-button icon-plus" (click)="openAddManuallyModal()"></span>
  <span class="ps-activity-top-button ps-activity-back icon-back" (click)="goBack()"></span>
  <ng-container *ngIf="userAccess">
    <div *ngIf="project" class="ps-stat-user-filter-wrapper">
      <swing-select [type]="'multiSelect'"
                    [items]="project.teamMembers | objectKeys"
                    [itemTextAttribute]="['name', 'email']"
                    (onItemClicked)="getSelectedUsers($event)"
                    [label]="'Select Users'"
                    [selectedItemIndex]="selectedItemIndex"></swing-select>
    </div>
  </ng-container>
  <div class="columns ps-activities-stat-wrapper">
    <ng-container *ngIf="projectActivities.length > 0">
      <div class="column is-offset-1 is-10" style="background-color: white">
        <chart *ngIf="project" [project]="project" [selectedUsers]="selectedUsers" (chartLoaded)="UpdatePageLoader(true)"></chart>
      </div>
    </ng-container>
    <ng-container *ngIf="projectActivities.length === 0">
      <div class="column is-offset-1 is-10" style="background-color: white">
        <div class="ps-activities-placeholder">
          <figure class="image">
            <img src="../../../../assets/images/placeholder.jpg">
          </figure>
          <p *ngIf="selectedUsers.length > 0 ">There is no activity yet!</p>
          <p *ngIf="selectedUsers.length === 0 ">Please select a member to show statistics</p>
        </div>
      </div>
    </ng-container>
  </div>
  <div class="columns">
    <div class="column is-offset-4-widescreen is-4-widescreen is-4-desktop is-offset-4-desktop is-6-tablet is-offset-3-tablet">
      <div *ngIf="currentActivityCopy" class="ps-activity-item">
        <ng-container>
          <div class="ps-header-container">
            <div class="ps-activity-header">
              Current Activity
            </div>
          </div>
          <div class="ps-card-container">
            <div>
              <activity-item [activity]="currentActivityCopy" [project]="project" [currentUser]="user"></activity-item>
            </div>
          </div>
        </ng-container>
      </div>
      <div *ngFor='let group of projectActivities; trackBy: let j = index' class="ps-activity-item">
        <ng-container *ngIf="group.activities.length > 0 && project">
          <div class="ps-header-container">
            <div class="ps-activity-header">
              {{group.date}} / {{group.duration}}
            </div>
          </div>
          <div class="ps-card-container">
            <div *ngFor='let activity of group.activities; trackBy: let i = index'>
              <activity-item [activity]="activity" [project]="project" [currentUser]="user" [deleteButtonDisabled]="deleteButtonDisabled"
                             (onDeleteClicked)="deleteActivity(activity, j, i)" (onEditClicked)="openEditManuallyModal(activity)"></activity-item>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>

<div class="pageloader" [ngClass]="{'is-active': !pageLoaded}">
  <span class="title">loading...</span>
</div>
